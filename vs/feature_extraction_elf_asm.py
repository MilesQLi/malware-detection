# feature_extraction_elf_asm.py
#
# Read a list of ELF ASM and section header files generated by objdump and extract
# feature sets from them.
#
# ELF executable platforms include: x86, amd64, ARM, SPARC, MIPS, Motorola, PowerPC, Renesas (SuperH).
#
# Input: A list of ELF binary files.
#
# Output: sorted-elf-features-asm.csv
#         row format = [file_name, [list of register counts], [list of opcode counts]]
#
# Author: Derek Chadwick
# Date  : 05/09/2016
#
# TODO: all of the things

from multiprocessing import Pool
import os
from csv import writer
import numpy as np
import pandas as pd
import math
import scipy.misc
import array
import time as tm
import re
import subprocess as sub




# Includes x86 and amd64 registers and opcodes.
x86_registers = ['edx','esi','es','fs','ds','ss','gs','cs','ah','al',
                 'ax','bh','bl','bx','ch','cl','cx','dh','dl','dx',
                 'eax','ebp','ebx','ecx','edi','esp','rax','rbx','rcx','rdx','rsi',
                 'rdi','rbp','rsp','r8','r9','r10','r11','r12','r13','r14','r15']

x86_opcodes = ['mov','movabs','movbe','movsbl','movsbw','movswl','movsbq','movswq','movslq','movsx',
               'movsxd','movzb','movzw','movzx','push','pusha','pop','popa','xchg','in','out','lea',
               'lds','les','lfs','lgs','lss','clc','cld','cli','clts','cmc','lahf','sahf','pushf',
               'popf','stc','std','sti','add','inc','sub','dec','sbb','cmp','test','and','or','xor',
               'clr','adc','neg','not','aaa','aas','daa','das','aad','aam','cbw','cdqe','cwde','cwd',
               'cdq','cqo','cbtw','cltq','cwtl','cwtd','cltd','cqto','mul','imul','div','idiv',
               'rol','ror','rcl','rcr','sal','shl','shr','sar','shld','shrd','call','lcall',
               'jmp','ljmp','ret','lret','retf','enter','leave','jo','jno','jb','jc','jnae','jnb',
               'jnc','jae','je','jz','jne','jnz','jbe','jna','jnbe','ja','js','jns','jp','jpe',
               'jnp','jpo','jl','jnge','jnl','jge','jle','jng','jnle','jg','jcxz','jecxz','jrcxz',
               'loop','loopz','loope','loopnz','loopne','seto','setno','setb','setc','setnae',
               'setnb','setnc','setae','sete','setz','setne','setnz','setbe','setna','setnbe',
               'seta','sets','setns','setp','setpe','setnp','setpo','setl','setnge','setnl',
               'setge','setle','setng','setnle','setg','cmps','scmp','ins','outs','lods',
               'slod','movs','smov','scas','ssca','stos','ssto','xlat','bsf','bsr','bt',
               'btc','btr','bts','int','int3','into','iret','rsm','bound','hlt','nop','arpl',
               'lar','lgdt','lidt','lldt','lmsw','lsl','ltr','sgdt','sidt','sldt','smsw','str',
               'verr','verw','fld','fild','fildll','fldt','fbld','fst','fist','fstp','fistp',
               'fistpll','fstpt','fbstp','fxch','fcom','ficom','fcomp','ficomp','fcompp','fucom',
               'fucomp','fucompp','ftst','fxam','fld1','fldl2t','fldl2e','fldpi','fldlg2','fldln2',
               'fldz','fadd','fiadd','faddp','fsub','fisub','fsubp','fsubr','fisubr','fsubrp',
               'fmul','fimul','fmulp','fdiv','fidiv','fdivp','fdivr','fidivr','fdivrp','f2xm1',
               'fyl2x','fptan','fpatan','fxtract','fprem1','fdecstp','fincstp','fprem','fyl2xp1',
               'fsqrt','fsincos','frndint','fscale','fsin','fcos','fchs','fabs','fninit','finit',
               'fldcw','fnstcw','fstcw','fnstsw','fstsw','fnclex','fclex','fnstenv','fstenv',
               'fldenv','fnsave','fsave','frstor','fneni','feni','fndisi','fdisi','fnsetpm',
               'fsetpm','frstpm','ffree','ffreep','fnop','fwait','addr16','addr32','aword',
               'adword','data16','data32','word','dword','lock','wait','cs','ds','es','fs',
               'gs','ss','rep','repe','repz','repne','repnz','ht','hnt','rex','rexz','rexy',
               'rexyz','rexx','rexxz','rexxy','rexxyz','rex64','rex64z','rex64y','rex64yz',
               'rex64x','rex64xz','rex64xy','rex64xyz','bswap','xadd','cmpxchg','invd','wbinvd',
               'invlpg','cpuid','wrmsr','rdtsc','rdmsr','cmpxchg8b','sysenter','sysexit','fxsave',
               'fxsave64','fxrstor','fxrstor64','rdpmc','ud2','ud2a','ud1','ud2b','cmovo','cmovno',
               'cmovb','cmovc','cmovnae','cmovae','cmovnc','cmovnb','cmove','cmovz','cmovne',
               'cmovnz','cmovbe','cmovna','cmova','cmovnbe','cmovs','cmovns','cmovp','cmovnp',
               'cmovl','cmovnge','cmovge','cmovnl','cmovle','cmovng','cmovg','cmovnle','cmovpe',
               'cmovpo','fcmovb','fcmovnae','fcmove','fcmovbe','fcmovna','fcmovu','fcmovae',
               'fcmovnb','fcmovne','fcmova','fcmovnbe','fcmovnu','fcomi','fucomi','fcomip',
               'fcompi','fucomip','fucompi','movnti','clflush','lfence','mfence','pause','emms',
               'movd','movq','packssdw','packsswb','packuswb','paddb','paddw','paddd','paddq',
               'paddsb','paddsw','paddusb','paddusw','pand','pandn','pcmpeqb','pcmpeqw','pcmpeqd',
               'pcmpgtb','pcmpgtw','pcmpgtd','pmaddwd','pmulhw','pmullw','por','psllw','pslld',
               'psllq','psraw','psrad','psrlw','psrld','psrlq','psubb','psubw','psubd','psubq',
               'psubsb','psubsw','psubusb','psubusw','punpckhbw','punpckhwd','punpckhdq',
               'punpcklbw','punpcklwd','punpckldq','pxor','addps','addss','andnps','andps',
               'cmpeqps','cmpeqss','cmpleps','cmpless','cmpltps','cmpltss','cmpneqps','cmpneqss',
               'cmpnleps','cmpnless','cmpnltps','cmpnltss','cmpordps','cmpordss','cmpunordps',
               'cmpunordss','cmpps','cmpss','comiss','cvtpi2ps','cvtps2pi','cvtsi2ss','cvtss2si',
               'cvttps2pi','cvttss2si','divps','divss','ldmxcsr','maskmovq','maxps','maxss',
               'minps','minss','movaps','movhlps','movhps','movlhps','movlps','movmskps','movntps',
               'movntq','movntdq','movss','movups','mulps','mulss','orps','pavgb','pavgw','pextrw',
               'pinsrw','pmaxsw','pmaxub','pminsw','pminub','pmovmskb','pmulhuw','prefetchnta',
               'prefetcht0','prefetcht1','prefetcht2','psadbw','pshufw','rcpps','rcpss','rsqrtps',
               'rsqrtss','sfence','shufps','sqrtps','sqrtss','stmxcsr','subps','subss','ucomiss',
               'unpckhps','unpcklps','xorps','addpd','addsd','andnpd','andpd','cmpeqpd','cmpeqsd',
               'cmplepd','cmplesd','cmpltpd','cmpltsd','cmpneqpd','cmpneqsd','cmpnlepd','cmpnlesd',
               'cmpnltpd','cmpnltsd','cmpordpd','cmpordsd','cmpunordpd','cmpunordsd','cmppd',
               'cmpsd','comisd','cvtpi2pd','cvtsi2sd','divpd','divsd','maxpd','maxsd','minpd',
               'minsd','movapd','movhpd','movlpd','movmskpd','movntpd','movsd','movupd','mulpd',
               'mulsd','orpd','shufpd','sqrtpd','sqrtsd','subpd','subsd','ucomisd','unpckhpd',
               'unpcklpd','xorpd','cvtdq2pd','cvtpd2dq','cvtdq2ps','cvtpd2pi','cvtpd2ps','cvtps2pd',
               'cvtps2dq','cvtsd2si','cvtsd2ss','cvtss2sd','cvttpd2pi','cvttsd2si','cvttpd2dq',
               'cvttps2dq','maskmovdqu','movdqa','movdqu','movdq2q','movq2dq','pmuludq','pshufd',
               'pshufhw','pshuflw','pslldq','psrldq','punpckhqdq','punpcklqdq','addsubpd','addsubps',
               'cmpxchg16b','fisttp','fisttpll','haddpd','haddps','hsubpd','hsubps','lddqu',
               'monitor','movddup','movshdup','movsldup','mwait','vmcall','vmclear','vmlaunch',
               'vmresume','vmptrld','vmptrst','vmread','vmwrite','vmxoff','vmxon','vmfunc','getsec',
               'invept','invvpid','invpcid','phaddw','phaddd','phaddsw','phsubw','phsubd','phsubsw',
               'pmaddubsw','pmulhrsw','pshufb','psignb','psignw','psignd','palignr','pabsb','pabsw',
               'pabsd','blendpd','blendps','blendvpd','blendvps','dppd','dpps','extractps','insertps',
               'movntdqa','mpsadbw','packusdw','pblendvb','pblendw','pcmpeqq','pextrb','pextrd',
               'pextrq','phminposuw','pinsrb','pinsrd','pinsrq','pmaxsb','pmaxsd','pmaxud','pmaxuw',
               'pminsb','pminsd','pminud','pminuw','pmovsxbw','pmovsxbd','pmovsxbq','pmovsxwd',
               'pmovsxwq','pmovsxdq','pmovzxbw','pmovzxbd','pmovzxbq','pmovzxwd','pmovzxwq',
               'pmovzxdq','pmuldq','pmulld','ptest','roundpd','roundps','roundsd','roundss',
               'pcmpgtq','pcmpestri','pcmpestrm','pcmpistri','pcmpistrm','crc32','xsave',
               'xsave64','xrstor','xrstor64','xgetbv','xsetbv','xsaveopt','xsaveopt64','aesdec',
               'aesdeclast','aesenc','aesenclast','aesimc','aeskeygenassist','pclmulqdq',
               'pclmullqlqdq','pclmulhqlqdq','pclmullqhqdq','pclmulhqhqdq','vaddpd','vaddps',
               'vaddsd','vaddss','vaddsubpd','vaddsubps','vandnpd','vandnps','vandpd','vandps',
               'vblendpd','vblendps','vblendvpd','vblendvps','vbroadcastf128','vbroadcastsd',
               'vbroadcastss','vcmpeq_ospd','vcmpeq_osps','vcmpeq_ossd','vcmpeq_osss','vcmpeqpd',
               'vcmpeqps','vcmpeqsd','vcmpeqss','vcmpeq_uqpd','vcmpeq_uqps','vcmpeq_uqsd',
               'vcmpeq_uqss','vcmpeq_uspd','vcmpeq_usps','vcmpeq_ussd','vcmpeq_usss','vcmpfalse_ospd',
               'vcmpfalse_osps','vcmpfalse_ossd','vcmpfalse_osss','vcmpfalsepd','vcmpfalseps',
               'vcmpfalsesd','vcmpfalsess','vcmpge_oqpd','vcmpge_oqps','vcmpge_oqsd','vcmpge_oqss',
               'vcmpgepd','vcmpgeps','vcmpgesd','vcmpgess','vcmpgt_oqpd','vcmpgt_oqps',
               'vcmpgt_oqsd','vcmpgt_oqss','vcmpgtpd','vcmpgtps','vcmpgtsd','vcmpgtss',
               'vcmple_oqpd','vcmple_oqps','vcmple_oqsd','vcmple_oqss','vcmplepd','vcmpleps',
               'vcmplesd','vcmpless','vcmplt_oqpd','vcmplt_oqps','vcmplt_oqsd','vcmplt_oqss',
               'vcmpltpd','vcmpltps','vcmpltsd','vcmpltss','vcmpneq_oqpd','vcmpneq_oqps',
               'vcmpneq_oqsd','vcmpneq_oqss','vcmpneq_ospd','vcmpneq_osps','vcmpneq_ossd',
               'vcmpneq_osss','vcmpneqpd','vcmpneqps','vcmpneqsd','vcmpneqss','vcmpneq_uspd',
               'vcmpneq_usps','vcmpneq_ussd','vcmpneq_usss','vcmpngepd','vcmpngeps','vcmpngesd',
               'vcmpngess','vcmpnge_uqpd','vcmpnge_uqps','vcmpnge_uqsd','vcmpnge_uqss','vcmpngtpd',
               'vcmpngtps','vcmpngtsd','vcmpngtss','vcmpngt_uqpd','vcmpngt_uqps','vcmpngt_uqsd',
               'vcmpngt_uqss','vcmpnlepd','vcmpnleps','vcmpnlesd','vcmpnless','vcmpnle_uqpd',
               'vcmpnle_uqps','vcmpnle_uqsd','vcmpnle_uqss','vcmpnltpd','vcmpnltps','vcmpnltsd',
               'vcmpnltss','vcmpnlt_uqpd','vcmpnlt_uqps','vcmpnlt_uqsd','vcmpnlt_uqss','vcmpordpd',
               'vcmpordps','vcmpordsd','vcmpord_spd','vcmpord_sps','vcmpordss','vcmpord_ssd',
               'vcmpord_sss','vcmppd','vcmpps','vcmpsd','vcmpss','vcmptruepd','vcmptrueps',
               'vcmptruesd','vcmptruess','vcmptrue_uspd','vcmptrue_usps','vcmptrue_ussd',
               'vcmptrue_usss','vcmpunordpd','vcmpunordps','vcmpunordsd','vcmpunord_spd',
               'vcmpunord_sps','vcmpunordss','vcmpunord_ssd','vcmpunord_sss','vcomisd',
               'vcomiss','vcvtdq2pd','vcvtdq2ps','vcvtpd2dq','vcvtpd2dqx','vcvtpd2dqy','vcvtpd2ps',
               'vcvtpd2psx','vcvtpd2psy','vcvtps2dq','vcvtps2pd','vcvtsd2si','vcvtsd2ss',
               'vcvtsi2sd','vcvtsi2ss','vcvtss2sd','vcvtss2si','vcvttpd2dq','vcvttpd2dqx',
               'vcvttpd2dqy','vcvttps2dq','vcvttsd2si','vcvttss2si','vdivpd','vdivps','vdivsd',
               'vdivss','vdppd','vdpps','vextractf128','vextractps','vhaddpd','vhaddps',
               'vhsubpd','vhsubps','vinsertf128','vinsertps','vlddqu','vldmxcsr','vmaskmovdqu',
               'vmaskmovpd','vmaskmovps','vmaxpd','vmaxps','vmaxsd','vmaxss','vminpd','vminps',
               'vminsd','vminss','vmovapd','vmovaps','vmovd','vmovddup','vmovdqa','vmovdqu',
               'vmovhlps','vmovhpd','vmovhps','vmovlhps','vmovlpd','vmovlps','vmovmskpd','vmovmskps',
               'vmovntdq','vmovntdqa','vmovntpd','vmovntps','vmovq','vmovsd','vmovshdup',
               'vmovsldup','vmovss','vmovupd','vmovups','vmpsadbw','vmulpd','vmulps','vmulsd',
               'vmulss','vorpd','vorps','vpabsb','vpabsd','vpabsw','vpackssdw','vpacksswb',
               'vpackusdw','vpackuswb','vpaddsb','vpaddsw','vpaddb','vpaddd','vpaddq','vpaddw',
               'vpaddusb','vpaddusw','vpalignr','vpand','vpandn','vpavgb','vpavgw','vpblendvb',
               'vpblendw','vpcmpeqb','vpcmpeqd','vpcmpeqq','vpcmpeqw','vpcmpestri','vpcmpestrm',
               'vpcmpgtb','vpcmpgtd','vpcmpgtq','vpcmpgtw','vpcmpistri','vpcmpistrm','vperm2f128',
               'vpermilpd','vpermilps','vpextrb','vpextrd','vpextrq','vpextrw','vphaddd','vphaddsw',
               'vphaddw','vphminposuw','vphsubd','vphsubsw','vphsubw','vpinsrb','vpinsrd','vpinsrq',
               'vpinsrw','vpmaddubsw','vpmaddwd','vpmaxsb','vpmaxsd','vpmaxsw','vpmaxub','vpmaxud',
               'vpmaxuw','vpminsb','vpminsd','vpminsw','vpminub','vpminud','vpminuw','vpmovmskb',
               'vpmovsxbd','vpmovsxbq','vpmovsxbw','vpmovsxdq','vpmovsxwd','vpmovsxwq','vpmovzxbd',
               'vpmovzxbq','vpmovzxbw','vpmovzxdq','vpmovzxwd','vpmovzxwq','vpmuldq','vpmulhrsw',
               'vpmulhuw','vpmulhw','vpmulld','vpmullw','vpmuludq','vpor','vpsadbw','vpshufb',
               'vpshufd','vpshufhw','vpshuflw','vpsignb','vpsignd','vpsignw','vpslld','vpslldq',
               'vpsllq','vpsllw','vpsrad','vpsraw','vpsrld','vpsrldq','vpsrlq','vpsrlw','vpsubb',
               'vpsubd','vpsubq','vpsubsb','vpsubsw','vpsubusb','vpsubusw','vpsubw','vptest',
               'vpunpckhbw','vpunpckhdq','vpunpckhqdq','vpunpckhwd','vpunpcklbw','vpunpckldq',
               'vpunpcklqdq','vpunpcklwd','vpxor','vrcpps','vrcpss','vroundpd','vroundps',
               'vroundsd','vroundss','vrsqrtps','vrsqrtss','vshufpd','vshufps','vsqrtpd','vsqrtps',
               'vsqrtsd','vsqrtss','vstmxcsr','vsubpd','vsubps','vsubsd','vsubss','vtestpd',
               'vtestps','vucomisd','vucomiss','vunpckhpd','vunpckhps','vunpcklpd','vunpcklps',
               'vxorpd','vxorps','vzeroall','vzeroupper','vbroadcasti128','vpblendd','vpbroadcastb',
               'vpbroadcastd','vpbroadcastq','vpbroadcastw','vperm2i128','vpermd','vpermpd',
               'vpermps','vpermq','vextracti128','vinserti128','vpmaskmovd','vpmaskmovq','vpsllvd',
               'vpsllvq','vpsravd','vpsrlvd','vpsrlvq','vgatherdpd','vgatherdps','vgatherqpd',
               'vgatherqps','vpgatherdd','vpgatherdq','vpgatherqd','vpgatherqq','vaesdec','vaesdeclast',
               'vaesenc','vaesenclast','vaesimc','vaeskeygenassist','vpclmulqdq','vpclmullqlqdq',
               'vpclmulhqlqdq','vpclmullqhqdq','vpclmulhqhqdq','rdfsbase','rdgsbase','rdrand',
               'wrfsbase','wrgsbase','vcvtph2ps','vcvtps2ph','vfmadd132pd','vfmadd132ps','vfmadd213pd',
               'vfmadd213ps','vfmadd231pd','vfmadd231ps','vfmadd132sd','vfmadd132ss','vfmadd213sd',
               'vfmadd213ss','vfmadd231sd','vfmadd231ss','vfmaddsub132pd','vfmaddsub132ps',
               'vfmaddsub213pd','vfmaddsub213ps','vfmaddsub231pd','vfmaddsub231ps','vfmsubadd132pd',
               'vfmsubadd132ps','vfmsubadd213pd','vfmsubadd213ps','vfmsubadd231pd','vfmsubadd231ps',
               'vfmsub132pd','vfmsub132ps','vfmsub213pd','vfmsub213ps','vfmsub231pd','vfmsub231ps',
               'vfmsub132sd','vfmsub132ss','vfmsub213sd','vfmsub213ss','vfmsub231sd','vfmsub231ss',
               'vfnmadd132pd','vfnmadd132ps','vfnmadd213pd','vfnmadd213ps','vfnmadd231pd',
               'vfnmadd231ps','vfnmadd132sd','vfnmadd132ss','vfnmadd213sd','vfnmadd213ss',
               'vfnmadd231sd','vfnmadd231ss','vfnmsub132pd','vfnmsub132ps','vfnmsub213pd',
               'vfnmsub213ps','vfnmsub231pd','vfnmsub231ps','vfnmsub132sd','vfnmsub132ss',
               'vfnmsub213sd','vfnmsub213ss','vfnmsub231sd','vfnmsub231ss','xacquire','xrelease',
               'xabort','xbegin','xend','xtest','bzhi','mulx','pdep','pext','rorx','sarx','shlx',
               'shrx','vfmaddpd','vfmaddps','vfmaddsd','vfmaddss','vfmaddsubpd','vfmaddsubps',
               'vfmsubaddpd','vfmsubaddps','vfmsubpd','vfmsubps','vfmsubsd','vfmsubss','vfnmaddpd',
               'vfnmaddps','vfnmaddsd','vfnmaddss','vfnmsubpd','vfnmsubps','vfnmsubsd','vfnmsubss',
               'vfrczpd','vfrczps','vfrczsd','vfrczss','vpcmov','vpcomb','vpcomd','vpcomq',
               'vpcomub','vpcomud','vpcomuq','vpcomuw','vpcomw','vpermil2pd','vpermil2ps',
               'vpcomltb','vpcomltd','vpcomltq','vpcomltub','vpcomltud','vpcomltuq','vpcomltuw',
               'vpcomltw','vpcomleb','vpcomled','vpcomleq','vpcomleub','vpcomleud','vpcomleuq',
               'vpcomleuw','vpcomlew','vpcomgtb','vpcomgtd','vpcomgtq','vpcomgtub','vpcomgtud',
               'vpcomgtuq','vpcomgtuw','vpcomgtw','vpcomgeb','vpcomged','vpcomgeq','vpcomgeub',
               'vpcomgeud','vpcomgeuq','vpcomgeuw','vpcomgew','vpcomeqb','vpcomeqd','vpcomeqq',
               'vpcomequb','vpcomequd','vpcomequq','vpcomequw','vpcomeqw','vpcomneqb','vpcomneqd',
               'vpcomneqq','vpcomnequb','vpcomnequd','vpcomnequq','vpcomnequw','vpcomneqw',
               'vpcomfalseb','vpcomfalsed','vpcomfalseq','vpcomfalseub','vpcomfalseud',
               'vpcomfalseuq','vpcomfalseuw','vpcomfalsew','vpcomtrueb','vpcomtrued','vpcomtrueq',
               'vpcomtrueub','vpcomtrueud','vpcomtrueuq','vpcomtrueuw','vpcomtruew','vphaddbd',
               'vphaddbq','vphaddbw','vphadddq','vphaddubd','vphaddubq','vphaddubw','vphaddudq',
               'vphadduwd','vphadduwq','vphaddwd','vphaddwq','vphsubbw','vphsubdq','vphsubwd',
               'vpmacsdd','vpmacsdqh','vpmacsdql','vpmacssdd','vpmacssdqh','vpmacssdql',
               'vpmacsswd','vpmacssww','vpmacswd','vpmacsww','vpmadcsswd','vpmadcswd','vpperm',
               'vprotb','vprotd','vprotq','vprotw','vpshab','vpshad','vpshaq','vpshaw','vpshlb',
               'vpshld','vpshlq','vpshlw','llwpcb','slwpcb','lwpval','lwpins','andn','bextr','blsi',
               'blsmsk','blsr','tzcnt','blcfill','blci','blcic','blcmsk','blcs','blsfill','blsic',
               't1mskc','tzmsk','prefetch','prefetchw','femms','pavgusb','pf2id','pf2iw','pfacc',
               'pfadd','pfcmpeq','pfcmpge','pfcmpgt','pfmax','pfmin','pfmul','pfnacc','pfpnacc',
               'pfrcp','pfrcpit1','pfrcpit2','pfrsqit1','pfrsqrt','pfsub','pfsubr','pi2fd','pi2fw',
               'pmulhrw','pswapd','syscall','sysret','swapgs','rdtscp','clgi','invlpga','skinit',
               'stgi','vmload','vmmcall','vmrun','vmsave','movntsd','movntss','extrq','insertq', 
               'popcnt','lzcnt','xstore','xcrypt','montmul','xsha1','xsha256','xstorerng',
               'xcryptecb','xcryptcbc','xcryptctr','xcryptcfb','xcryptofb','xstore','adcx','adox',
               'rdseed','clac','stac','bnd','bndmk','bndmov','bndcl','bndcu','bndcn','bndstx',
               'bndldx','sha1rnds4','sha1nexte','sha1msg1','sha1msg2','sha256rnds2','sha256msg1','sha256msg2',
               'kandnw','kandw','korw','kxnorw','kxorw','kmovw','knotw','kortestw','kshiftlw',
               'kshiftrw','kunpckbw','valignd','vpternlogd','valignq','vpternlogq','vblendmpd',
               'vpblendmq','vpermi2pd','vpermi2q','vpermt2pd','vpermt2q','vpmaxsq','vpmaxuq',
               'vpminsq','vpminuq','vprolvq','vprorvq','vpsravq','vblendmps','vpblendmd',
               'vpermi2d','vpermi2ps','vpermt2d','vpermt2ps','vprolvd','vprorvd','vbroadcastf32x4',
               'vbroadcasti32x4','vbroadcastf64x4','vbroadcasti64x4','vcmpeq_oqpd','vcmpfalse_oqpd',
               'vcmpge_ospd','vcmpgt_ospd','vcmple_ospd','vcmplt_ospd','vcmpneq_uqpd','vcmpnge_uspd',
               'vcmpngt_uspd','vcmpnle_uspd','vcmpnlt_uspd','vcmpord_qpd','vcmptrue_uqpd',
               'vcmpunord_qpd','vcmpeq_oqps','vcmpfalse_oqps','vcmpge_osps','vcmpgt_osps',
               'vcmple_osps','vcmplt_osps','vcmpneq_uqps','vcmpnge_usps','vcmpngt_usps',
               'vcmpnle_usps','vcmpnlt_usps','vcmpord_qps','vcmptrue_uqps','vcmpunord_qps',
               'vcmpeq_oqsd','vcmpfalse_oqsd','vcmpge_ossd','vcmpgt_ossd','vcmple_ossd','vcmplt_ossd',
               'vcmpneq_uqsd','vcmpnge_ussd','vcmpngt_ussd','vcmpnle_ussd','vcmpnlt_ussd',
               'vcmpord_qsd','vcmptrue_uqsd','vcmpunord_qsd','vcmpeq_oqss','vcmpfalse_oqss',
               'vcmpge_osss','vcmpgt_osss','vcmple_osss','vcmplt_osss','vcmpneq_uqss',
               'vcmpnge_usss','vcmpngt_usss','vcmpnle_usss','vcmpnlt_usss','vcmpord_qss',
               'vcmptrue_uqss','vcmpunord_qss','vcompresspd','vpcompressq','vpscatterdq',
               'vpscatterqq','vscatterdpd','vscatterqpd','vcompressps','vpcompressd','vpscatterdd',
               'vscatterdps','vcvtudq2pd','vcvtps2udq','vcvtpd2udq','vcvtsd2usi','vcvtusi2sd',
               'vcvtusi2ss','vcvtss2usi','vcvttpd2udq','vcvttps2udq','vcvttsd2usi','vcvttss2usi',
               'vcvtudq2ps','vexpandpd','vpexpandq','vexpandps','vpexpandd','vextractf32x4',
               'vextracti32x4','vextractf64x4','vextracti64x4','vfixupimmpd','vfixupimmps',
               'vfixupimmsd','vgetmantsd','vrndscalesd','vfixupimmss','vgetmantss','vrndscaless',
               'vscalefpd','vscalefps','vscalefsd','vscalefss','vgetexppd','vgetexpps',
               'vgetexpsd','vgetexpss','vgetmantpd','vrndscalepd','vgetmantps','vrndscaleps',
               'vinsertf32x4','vinserti32x4','vinsertf64x4','vinserti64x4','vmovdqa64',
               'vmovdqa32','vmovdqu32','vmovdqu64','vrcp14ps','vrsqrt14ps','vpabsq',
               'vrcp14pd','vrsqrt14pd','vpandd','vpandnd','vpord','vpxord','vpandnq',
               'vpandq','vporq','vpxorq','vpcmpd','vpcmpled','vpcmpltd','vpcmpneqd',
               'vpcmpnled','vpcmpnltd','vpcmpud','vpcmpequd','vpcmpleud','vpcmpltud',
               'vpcmpnequd','vpcmpnleud','vpcmpnltud','vpcmpq','vpcmpleq','vpcmpltq',
               'vpcmpneqq','vpcmpnleq','vpcmpnltq','vpcmpuq','vpcmpequq','vpcmpleuq',
               'vpcmpltuq','vpcmpnequq','vpcmpnleuq','vpcmpnltuq','vptestmq','vpmovdb',
               'vpmovsdb','vpmovusdb','vpmovdw','vpmovsdw','vpmovusdw','vpmovqb','vpmovsqb',
               'vpmovusqb','vpmovqd','vpmovsqd','vpmovusqd','vpmovqw','vpmovsqw','vpmovusqw',
               'vprold','vprord','vprolq','vprorq','vpscatterqd','vscatterqps','vpsraq',
               'vptestmd','vrcp14sd','vrsqrt14sd','vrcp14ss','vrsqrt14ss','vshuff32x4',
               'vshufi32x4','vshuff64x2','vshufi64x2','vptestnmd','vptestnmq','vpbroadcastmb2q',
               'vpbroadcastmw2d','vpconflictd','vpconflictq','vplzcntd','vplzcntq','vexp2pd',
               'vexp2ps','vrcp28pd','vrsqrt28pd','vrcp28ps','vrsqrt28ps','vrcp28sd',
               'vrsqrt28sd','vrcp28ss','vrsqrt28ss','vgatherpf0dpd','vgatherpf0qpd',
               'vgatherpf1dpd','vgatherpf1qpd','vscatterpf0dpd','vscatterpf0qpd',
               'vscatterpf1dpd','vscatterpf1qpd','vgatherpf0dps','vgatherpf0qps',
               'vgatherpf1dps','vgatherpf1qps','vscatterpf0dps','vscatterpf0qps',
               'vscatterpf1dps','vscatterpf1qps','prefetchwt1','clflushopt','xrstors',
               'xrstors64','xsaves','xsaves64','xsavec','xsavec64','encls','enclu',
               'vcvtpd2udqx','vcvtpd2udqy','vcvttpd2udqx','vcvttpd2udqy','kaddd','kandd',
               'kandnd','kmovd','knotd','kord','kortestd','ktestd','kxnord','kxord','kaddq',
               'kandnq','kandq','kmovq','knotq','korq','kortestq','ktestq','kunpckdq',
               'kunpckwd','kxnorq','kxorq','kshiftld','kshiftlq','kshiftrd','kshiftrq',
               'vdbpsadbw','vmovdqu16','vmovdqu8','vpblendmb','vpblendmw','vpermi2w',
               'vpermt2w','vpermw','vpsllvw','vpsravw','vpsrlvw','vpcmpb','vpcmpub',
               'vpcmpuw','vpcmpw','vpmovb2m','vpmovm2b','vpmovm2w','vpmovswb','vpmovuswb',
               'vpmovwb','vpmovw2m','vptestmb','vptestmw','vptestnmb','vptestnmw','kaddb',
               'kandb','kandnb','kmovb','knotb','korb','kortestb','ktestb','kxnorb','kxorb',
               'kaddw','ktestw','kshiftlb','kshiftrb','vbroadcastf32x2','vbroadcastf32x8',
               'vbroadcasti32x2','vbroadcasti32x8','vbroadcastf64x2','vbroadcasti64x2',
               'vcvtpd2qq','vcvtpd2uqq','vcvtps2qq','vcvtps2uqq','vcvtqq2pd','vcvtuqq2pd',
               'vcvtqq2ps','vcvtqq2psx','vcvtqq2psy','vcvttpd2qq','vcvttpd2uqq','vcvttps2qq',
               'vcvttps2uqq','vcvtuqq2ps','vcvtuqq2psx','vcvtuqq2psy','vextractf32x8',
               'vextracti32x8','vinsertf32x8','vinserti32x8','vfpclassss','vextractf64x2',
               'vextracti64x2','vfpclasssd','vinsertf64x2','vinserti64x2','vfpclasspd',
               'vfpclasspdz','vfpclasspdx','vfpclasspdy','vfpclassps','vfpclasspsz','vfpclasspsx',
               'vfpclasspsy','vpmovd2m','vpmovm2d','vpmovm2q','vpmovq2m','vpmullq','vrangepd',
               'vreducepd','vrangeps','vreduceps','vrangesd','vreducesd','vrangess','vreducess',
               'clwb','pcommit','vpmadd52huq','vpmadd52luq','vpmultishiftqb','vpermb','vpermi2b',
               'vpermt2b','clzero','monitorx','mwaitx','rdpkru','wrpkru','rdpid']

# DEPRECATED: use x86 above.
amd64_registers = ['rax','rbx','rcx','rdx','rsi','rdi','rbp','rsp','r8','r9','r10','r11','r12','r13','r14','r15']

amd64_opcodes = ['aaa','aad','aam','aas','adc','add','and','andn','bextr','bextr','blcfill','blci','blcic',
                 'blcmsk','blcs','blsfill','blsi','blsic','blsmsk','blsr','bound','bsf','bsr','bswap','bt',
                 'btc','btr','bts','bzhi','call','cbw','cwde','cdqe','cwd','cdq','cqo','clc','cld','clflush','cmc','cmov',
                 'cmp','cmps','cmpsb','cmpsw','cmpsd','cmpsq','cmpxchg','cmpxchg8b','cmpxchg16b','cpuid',
                 'crc32','daa','das','dec','div','enter','idiv','imul','in','inc','ins','insb','insw','insd',
                 'int','into','jcxz','jecxz','jrcxz','jmp','lahf','lds','les','lfs','lgs','lss','lea','leave','lfence',
                 'llwpcb','lods','lodsb','lodsw','lodsd','lodsq','loop','loope','loopne','loopnz','loopz','lwpins',
                 'lwpval','lzcnt','mfence','mov','movbe','movd','movmskpd','movmskps','movnti','movs','movsb',
                 'movsw','movsd','movsq','movsx','movsxd','movzx','mul','mulx','neg','nop','not','or','out',
                 'outs','outsb','outsw','outsd','pause','pdep','pext','pop','popa','popad','popcnt','popf','popfd',
                 'popfq','prefetch','prefetchw','prefetch','push','pusha','pushad','pushf','pushfd','pushfq',
                 'rcl','rcr','rdfsbase','rdgsbase','rdrand','ret','rol','ror','rorx','sahf','sal','shl','sar','sarx',
                 'sbb','scas','scasb','scasw','scasd','scasq','set','sfence','shl','shld','shlx',
                 'shr','shrd','shrx','slwpcb','stc','std','stos','stosb','stosw','stosd','stosq','sub','t1mskc',
                 'test','tzcnt','tzmsk','wrfsbase','wrgsbase','xadd','xchg','xlat','xlatb','xor','arpl','clgi','cli',
                 'clts','hlt','int','invd','invlpg','invlpga','iret','iretd','iretq','lar','lgdt','lidt','lldt',
                 'lmsw','lsl','ltr','monitor','monitorx','mwait','mwaitx','rdmsr','rdpmc','rdtsc','rdtscp',
                 'rsm','sgdt','sidt','skinit','sldt','smsw','sti','stgi','str','swapgs',
                 'syscall','sysenter','sysexit','sysret','ud2','verr','verw',
                 'vmload','vmmcall','vmrun','vmsave','wbinvd','wrmsr']

MIPS_registers = ['$zero','$at','$v0','$v1','$a0','$a1','$a2','$a3','$a4','$a5','$a6','$a7',
                  '$t4','$t5','$t6','$t7','$s0','$s1','$s2','$s3','$s4','$s5','$s6','$s7',
                  '$t8','$t9','$k0','$k1','$gp','$sp','$s8','$fp','$ra',
                  '$0','$1','$2','$3','$4','$5','$6','$7','$8','$9','$10','$11','$12','$13','$14','$15',
                  '$16','$17','$18','$19','$20','$21','$22','$23','$24','$25','$26','$27','$28','$29','$30','$31']

MIPS_opcodes = ['pref','prefx','nop','ssnop','ehb','li','move','b','nal','bal','bc','balc','lapc',
                'la','campi','campv','camwi','ramri','gsle','gsgt','gslble','gslbgt','gslhle',
                'gslhgt','gslwle','gslwgt','gsldle','gsldgt','gssble','gssbgt','gsshle','gsshgt',
                'gsswle','gsswgt','gssdle','gssdgt','gslwlec1','gslwgtc1','gsldlec1','gsldgtc1',
                'gsswlec1','gsswgtc1','gssdlec1','gssdgtc1','gslwlc1','gslwrc1','gsldlc1','gsldrc1',
                'gsswlc1','gsswrc1','gssdlc1','gssdrc1','gslbx','gslhx','gslwx','gsldx','gssbx',
                'gsshx','gsswx','gssdx','gslwxc1','gsldxc1','gsswxc1','gssdxc1','gslq','gssq',
                'gslqc1','gssqc1','vabs','vadd','vaddi','vaddq','vaddw','vaddx','vaddy','vaddz',
                'vadda','vaddai','vaddaq','vaddaw','vaddax','vadday','vaddaz','vcallms','vcallmsr',
                'vclipw','vdiv','vftoi0','vftoi4','vftoi12','vftoi15','viadd','viaddi','viand',
                'vilwr','vior','viswr','visub','vitof0','vitof4','vitof12','vitof15','vlqd',
                'vlqi','vmadd','vmaddi','vmaddq','vmaddw','vmaddx','vmaddy','vmaddz','vmadda',
                'vmaddai','vmaddaq','vmaddaw','vmaddax','vmadday','vmaddaz','vmax','vmaxi','vmaxw',
                'vmaxx','vmaxy','vmaxz','vmfir','vmini','vminii','vminiw','vminix','vminiy',
                'vminiz','vmove','vmr32','vmsub','vmsubi','vmsubq','vmsubw','vmsubx','vmsuby',
                'vmsubz','vmsuba','vmsubai','vmsubaq','vmsubaw','vmsubax','vmsubay','vmsubaz',
                'vmtir','vmul','vmuli','vmulq','vmulw','vmulx','vmuly','vmulz','vmula','vmulai',
                'vmulaq','vmulaw','vmulax','vmulay','vmulaz','vnop','vopmula','vopmsub','vrget',
                'vrinit','vrnext','vrsqrt','vrxor','vsqd','vsqi','vsqrt','vsub','vsubi','vsubq',
                'vsubw','vsubx','vsuby','vsubz','vsuba','vsubai','vsubaq','vsubaw','vsubax',
                'vsubay','vsubaz','vwaitq','abs','aclr','add','adda','addi','addiu','addiupc',
                'addl','addr','addu','alni','alnv','and','andi','aset','baddu','bbit032',
                'bbit0','bbit132','bbit1','bc1any2f','bc1any2t','bc1any4f','bc1any4t','bc1eqz',
                'bc1f','bc1fl','bc1nez','bc1t','bc1tl','beqz','beqzl','beq','beql','bge','bgel',
                'bgeu','bgeul','bgez','bgezl','bgezal','bgezall','bgt','bgtl','bgtu','bgtul',
                'bgtz','bgtzl','ble','blel','bleu','bleul','blez','blezl','blt','bltl','bltu',
                'bltul','bltz','bltzl','bltzal','bltzall','bnez','bnezl','bne','bnel','break',
                'cabs','flushi','flushd','flushid','wb','cache','ceil','cfc1','cftc1','cftc2',
                'cins32','cins','clo','clz','ctc1','cttc1','cttc2','cvt','dabs','dadd','daddi',
                'daddiu','daddu','daddwc','dbreak','dclo','dclz','dctr','dctw','deret','dext',
                'dextm','dextu','dmod','ddiv','dmodu','ddivu','di','dins','dinsm','dinsu','mod',
                'modu','div','div1','divu','divu1','dla','dlca','dli','dmacc','dmacchi','dmacchis',
                'dmacchiu','dmacchius','dmaccs','dmaccu','dmaccus','dmadd16','dmfc0','dmfgc0','dmt',
                'dmtc0','dmtgc0','dmfc1','dmtc1','dmuh','dmul','dmulo','dmulou','dmult','dmulu',
                'dmuhu','dmultu','dneg','dnegu','dpop','drem','dremu','dret','drol','dror','drorv',
                'dror32','drotl','drotr','drotrv','drotr32','dsbh','dshd','dsllv','dsll32','dsll',
                'dsrav','dsra32','dsra','dsrlv','dsrl32','dsrl','dsub','dsubu','dvpe','dvp','ei',
                'emt','eret','eretnc','evpe','evp','ext','exts32','exts','floor','hibernate',
                'hypcall','ins','iret','jr','j','jalr','jal','jalx','laa','laad','lac','lacd',
                'lad','ladd','lai','laid','las','lasd','law','lawd','lb','lbu','lbx','lbux',
                'ldx','lhx','lhux','lwx','lwux','lca','ldpc','ld','ldaddw','ldaddwu','ldaddd',
                'ldc1','l','ldc2','ldc3','ldl','ldr','ldxc1','lh','lhu','ll','lld','lq','lqc2',
                'lui','luxc1','lwpc','lw','lwc0','lwc1','lwc2','lwc3','lwl','lcache','lwr',
                'flush','fork','lwupc','lwu','lwxc1','lwxs','macc','maccs','macchi','macchis',
                'macchiu','macchius','maccu','maccus','mad','madu','madd','madd1','madda',
                'maddp','maddu','maddu1','madd16','max','mfbpc','mfdab','mfdabm','mfdvb',
                'mfdvbm','mfiab','mfiabm','mfpc','mfps','mftacx','mftc0','mftc1','mftc2',
                'mftdsp','mftgpr','mfthc1','mfthc2','mfthi','mftlo','mftr','mfc0','mfgc0',
                'mfhc0','mfhgc0','mfc1','mfhc1','mfdr','mfhi','mfhi1','mflo','mflo1','mflhxu',
                'mfcr','mfsa','min','mov','movf','movn','movnz','ffc','movt','movz','ffs','msac',
                'msacu','msachi','msachiu','msgn','msgsnd','msgld','msgwait','msub','msuba',
                'msubu','mtbpc','mtdab','mtdabm','mtdvb','mtdvbm','mtiab','mtiabm','mtpc',
                'mtps','mtc0','mtgc0','mthc0','mthgc0','mtc1','mthc1','mtdr','mthi','mthi1',
                'mtlo','mtlo1','mtlhx','mtcr','mtm0','mtm1','mtm2','mtp0','mtp1','mtp2','mtsa',
                'mtsab','mtsah','mttc0','mttc1','mttc2','mttacx','mttdsp','mttgpr','mtthc1',
                'mtthc2','mtthi','mttlo','mttr','mul','muh','muhu','mula','mulhi','mulhiu',
                'mull','mulo','mulou','mulr','muls','mulsu','mulshi','mulshiu','mulsl','mult',
                'mult1','multp','multu','multu1','mulu','neg','negu','nmadd','nmsub','nor',
                'not','or','ori','pabsdiff','pabsdiffc','pause','pavg','pabsh','pabsw','paddsw',
                'paddub','padduh','padduw','padsbh','pand','pceqb','pceqh','pceqw','pcgtb',
                'pcgth','pcgtw','pcpyh','pcpyld','pcpyud','pdivbw','pdivuw','pdivw','pexch',
                'pexcw','pexeh','pexew','pext5','pextlb','pextlh','pextlw','pextub','pextuh',
                'pextuw','phmadh','phmsbh','pickf','pickt','pinteh','pinth','pll','plu',
                'plzcw','pmaddh','pmadduw','pmaddw','pmaxh','pmaxw','pmfhi','pmfhl','pmflo',
                'pminh','pminw','pmsubh','pmsubw','pmthi','pmthl','pmtlo','pmulth','pmultuw',
                'pmultw','pnor','pop','por','ppac5','ppacb','ppach','ppacw','prevh','prot3w',
                'psllvw','psravw','psrlvw','psubsw','psubub','psubuh','psubuw','pxor','pul',
                'puu','pperm','qfsrv','qmac','qmacs','rach','racl','racm','recip','recip1',
                'recip2','rem','remu','rdhwr','rdpgpr','rnas','rnau','rnes','rneu','rol','ror',
                'rorv','rotl','rotr','rotrv','round','rsqrt','rsqrt1','rsqrt2','rzs','rzu','saa',
                'saad','sb','sc','scd','sd','sdbbp','sdc1','sdc2','sdc3','s','sdl','sdr','sdxc1',
                'seb','seh','selsl','selsr','seq','seqi','sge','sgeu','sgt','sgtu','sh','shfl',
                'sigrie','sle','sleu','sllv','sll','slt','slti','sltiu','sltu','sne','snei','sq',
                'sqc2','sqrt','srav','sra','srlv','srl','standby','sub','suba','subl','subu',
                'suspend','suxc1','sw','swapw','swapwu','swapd','swc0','swc1','swc2','swc3',
                'swl','scache','swr','invalidate','swxc1','synciobdma','syncs','syncw','syncws',
                'sync_acquire','sync_mb','sync_release','sync_rmb','sync_wmb','sync','synci',
                'syscall','teqi','teq','tgei','tge','tgeiu','tgeu','tlbinv','tlbinvf','tlbp',
                'tlbr','tlbwi','tlbwr','tlbgr','tlbgwi','tlbginv','tlbginvf','tlbgwr','tlbgp',
                'tlti','tlt','tltiu','tltu','tnei','tne','trunc','uld','ulh','ulhu','ulw','usd',
                'ush','usw','v3mulu','vmm0','vmulu','wach','wacl','wait','waiti','wrpgpr','wsbh',
                'xor','xori','yield','zcb','zcbt','ctc0','cfc0','bc2eqz','bc2f','bc2fl','bc2nez',
                'bc2t','bc2tl','cfc2','ctc2','dmfc2','dmtc2','mfc2','mfhc2','mtc2','mthc2','qmfc2',
                'qmtc2','bc3f','bc3fl','bc3t','bc3tl','cfc3','ctc3','dmfc3','dmtc3','mfc3','mtc3',
                'addciu','absq_s','addq','addq_s','addsc','addu_s','addwc','bitrev','bposge32',
                'bposge32c','bposge64','cmp','cmpgu','cmpu','dextpdp','dextpdpv','dextp','dextpv',
                'dextr','dextr_r','dextr_rs','dextr_s','dextrv','dextrv_r','dextrv_rs','dextrv_s',
                'dinsv','dmadd','dmaddu','dmsub','dmsubu','dmthlip','dpaq_sa','dpaq_s','dpau',
                'dpsq_sa','dpsq_s','dpsu','dshilo','dshilov','extpdp','extpdpv','extp','extpv',
                'extr_rs','extr_r','extr_s','extrv_rs','extrv_r','extrv_s','extrv','extr','insv',
                'maq_sa','maq_s','modsub','mthlip','muleq_s','muleu_s','mulq_rs','mulsaq_s',
                'packrl','pick','preceq','precequ','preceu','precrq','precrq_rs','precrqu_s',
                'raddu','rddsp','repl','replv','shilo','shilov','shll','shll_s','shllv','shllv_s',
                'shra','shra_r','shrav','shrav_r','shrl','shrlv','subq','subq_s','subu_s','wrdsp',
                'adduh','adduh_r','append','balign','cmpgdu','dpa','dps','mul_s','mulq_s','mulsa',
                'precr','precr_sra','precr_sra_r','prepend','subuh','subuh_r','addqh','addqh_r',
                'subqh','subqh_r','dpax','dpsx','dpaqx_s','dpaqx_sa','dpsqx_s','dpsqx_sa','bc0f',
                'bc0fl','bc0t','bc0tl','gsmult','gsmultu','gsdmult','gsdmultu','gsdiv','gsdivu',
                'gsddiv','gsddivu','gsmod','gsmodu','gsdmod','gsdmodu','packsshb','packsswh',
                'packushb','paddb','paddh','paddw','paddd','paddsb','paddsh','paddusb','paddush',
                'pandn','pavgb','pavgh','pcmpeqb','pcmpeqh','pcmpeqw','pcmpgtb','pcmpgth','pcmpgtw',
                'pextrh','pinsrh_0','pinsrh_1','pinsrh_2','pinsrh_3','pmaddhw','pmaxsh','pmaxub',
                'pminsh','pminub','pmovmskb','pmulhuh','pmulhh','pmullh','pmuluw','pasubub','biadd',
                'pshufh','psllh','psllw','psrah','psraw','psrlh','psrlw','psubb','psubh','psubw',
                'psubd','psubsb','psubsh','psubusb','psubush','punpckhbh','punpckhhw','punpckhwd',
                'punpcklbh','punpcklhw','punpcklwd','sequ','lbue','lhue','lbe','lhe','lle','lwe',
                'lwle','lwre','sbe','sce','she','swe','swle','swre','cachee','prefe','slli','srai',
                'srli','bclr','bclri','bset','bseti','bneg','bnegi','binsl','binsli','binsr','binsri',
                'addv','addvi','subv','subvi','max_s','maxi_s','max_u','maxi_u','min_s','mini_s',
                'min_u','mini_u','max_a','min_a','ceq','ceqi','clt_s','clti_s','clt_u','clti_u',
                'cle_s','clei_s','cle_u','clei_u','st','sat_s','sat_u','add_a','adds_a','adds_s',
                'adds_u','ave_s','ave_u','aver_s','aver_u','subs_s','subs_u','subsus_u','subsuu_s',
                'asub_s','asub_u','mulv','maddv','msubv','div_s','div_u','mod_s','mod_u','dotp_s',
                'dotp_u','dpadd_s','dpadd_u','dpsub_s','dpsub_u','sld','sldi','splat','splati','pckev',
                'pckod','ilvl','ilvr','ilvev','ilvod','vshf','srar','srari','srlr','srlri','hadd_s',
                'hadd_u','hsub_s','hsub_u','nori','bmnz','bmnzi','bmz','bmzi','bsel','bseli','shf',
                'bnz','bz','fill','pcnt','nloc','nlzc','copy_s','copy_u','insert','insve',
                'ldi','fcaf','fcun','fceq','fcueq','fclt','fcult','fcle','fcule','fsaf','fsun',
                'fseq','fsueq','fslt','fsult','fsle','fsule','fadd','fsub','fmul','fdiv','fmadd',
                'fmsub','fexp2','fexdo','ftq','fmin','fmin_a','fmax','fmax_a','fcor','fcune',
                'fcne','mul_q','madd_q','msub_q','fsor','fsune','fsne','mulr_q','maddr_q','msubr_q',
                'fclass','ftrunc_s','ftrunc_u','fsqrt','frsqrt','frcp','frint','flog2','fexupl',
                'fexupr','ffql','ffqr','ftint_s','ftint_u','ffint_s','ffint_u','ctcmsa','cfcmsa',
                'udi0','udi1','udi2','udi3','udi4','udi5','udi6','udi7','udi8','udi9','udi10',
                'udi11','udi12','udi13','udi14','udi15','lsa','dlsa','aui','auipc','daui','dahi',
                'dati','align','dalign','bitswap','dbitswap','bovc','beqzalc','beqc','bnvc',
                'bnezalc','bnec','blezc','bgezc','bgec','bgtzc','bltzc','bltc','blezalc','bgezalc',
                'bgeuc','bgtzalc','bltzalc','bltuc','beqzc','jrc','jic','bnezc','jalrc','jialc',
                'maddf','msubf','rint','class','mina','maxa','sel','selnez','seleqz','aluipc']

SPARC_registers = []

SPARC_opcodes = []

ARM_registers = ['r0','r1','r2','r3','r4','r5','r6','r7','r8','r9','r10','r11','r12','r13','r14','r15','cpsr']

ARM_opcodes = ['mia','miaph','mar','mra','tandc','tbcst','textrc','textrm','tinsr','tmcr','tmcrr',
               'tmia','tmiaph','tmovmsk','tmrc','tmrrc','torc','torvsc','wabs','wacc','wadd',
               'waddbhus','waddsubhx','waligni','walignr','wand','wavg2','wavg4','wcmpeq','wcmpgt',
               'wldr','wmac','wmadd','wmax','wmerge','wmia','wmiaw','wmin','wmul','wmulwsm','wmulwum',
               'wmulwl','wqmia','wqmulm','wqmulwm','wor','wpack','wror','wsad','wshufh','wsll','wsra',
               'wsrl','wstr','wsub','wsubaddhx','wabsdiff','wunpckeh','wunpckel','wunpckih','wunpckil',
               'wxor','adf','muf','suf','rsf','dvf','rdf','pow','rpw','rmf','fml','fdv','frd','pol',
               'mvf','mnf','abs','rnd','sqt','log','lgn','exp','sin','cos','tan','asn','acs','atn',
               'urd','nrm','flt','fix','wfs','rfs','wfc','rfc','cmf','cnf','cmfe','cnfe','stf','ldf',
               'sfm','lfm','vpush','vstmdb','vldmdb','vstmia','vpop','vldmia','vstr','vldr','fstmdbx',
               'fldmdbx','fstmiax','fldmiax','vdup','vmov','vcvt','vmsr','vmrs','vcmp','vabs','vneg',
               'vsqrt','vmla','vmls','vnmls','vnmla','vmul','vnmul','vadd','vsub','vdiv','cfldrs',
               'cfldrd','cfldr32','cfldr64','cfstrs','cfstrd','cfstr32','cfstr64','cfmvsr','cfmvrs',
               'cfmvdlr','cfmvrdl','cfmvdhr','cfmvrdh','cfmv64lr','cfmvr64l','cfmv64hr','cfmvr64h',
               'cfmval32','cfmv32al','cfmvam32','cfmv32am','cfmvah32','cfmv32ah','cfmva32','cfmv32a',
               'cfmva64','cfmv64a','cfmvsc32','cfmv32sc','cfcpys','cfcpyd','cfcvtsd','cfcvtds','cfcvt32s',
               'cfcvt32d','cfcvt64s','cfcvt64d','cfcvts32','cfcvtd32','cftruncs32','cftruncd32','cfrshl32',
               'cfrshl64','cfsh32','cfsh64','cfcmps','cfcmpd','cfcmp32','cfcmp64','cfabss','cfabsd','cfnegs',
               'cfnegd','cfadds','cfaddd','cfsubs','cfsubd','cfmuls','cfmuld','cfabs32','cfabs64',
               'cfneg32','cfneg64','cfadd32','cfadd64','cfsub32','cfsub64','cfmul32','cfmul64','cfmac32',
               'cfmsc32','cfmadd32','cfmsub32','cfmadda32','cfmsuba32','vfma','vfms','vfnma','vfnms',
               'vsel','vmaxnm','vminnm','vrint','mcrr','mrrc','cdp','mrc','mcr','stc','ldc','mrrc2',
               'mcrr2','ldc2','stc2','cdp2','mcr2','mrc2','vmovx','vext','vtbl','vtbx','aese','aesd',
               'aesmc','aesimc','sha1h','sha1su1','sha256su0','vmovl','vcnt','vmvn','vswp','vmovn',
               'vqmovun','vqmovn','vshll','vrecpe','vrsqrte','vrev64','vrev32','vrev16','vcls','vclz',
               'vqabs','vqneg','vtrn','vuzp','vzip','vcgt','vcge','vceq','vcle','vclt','vpaddl',
               'vpadal','sha1c','sha1p','sha1m','sha1su0','sha256h','sha256h2','sha256su1','vand',
               'vbic','vorr','vorn','veor','vbsl','vbit','vbif','vmax','vrecps','vmin','vrsqrts',
               'vpadd','vacge','vpmax','vabd','vacgt','vpmin','vtst','vqdmulh','vqrdmulh','vhadd',
               'vqadd','vrhadd','vhsub','vqsub','vshl','vqshl','vrshl','vqrshl','vaba','vqrdmlah',
               'vqrdmlsh','vshrn','vrshrn','vqshrun','vqrshrun','vqshrn','vqrshrn','vsri','vsli',
               'vqshlu','vshr','vsra','vrshr','vrsra','vmull','vaddhn','vsubhn','vqdmlal','vqdmlsl',
               'vqdmull','vraddhn','vrsubhn','vaddl','vaddw','vsubl','vsubw','vabal','vabdl','vmlal',
               'vmlsl','vld4','vld1','vld2','vld3','bx','mul','mla','swp','stlex','ldaex',
               'stlexd','ldaexd','stlexb','ldaexb','stlexh','ldaexh','stl','lda','stlb','ldab','stlh',
               'ldah','sdiv','udiv','nop','bfc','bfi','mls','strht','ldr','movw','movt','rbit','smc',
               'ldrexb','ldrexd','ldrexh','strexb','strexd','strexh','yield','wfe','wfi','sev','pkhbt',
               'pkhtb','ldrex','qadd16','qadd8','qasx','qsub16','qsub8','qsax','sadd16','sadd8','sasx',
               'shadd16','shadd8','shasx','shsub16','shsub8','shsax','ssub16','ssub8','ssax','uadd16',
               'uadd8','uasx','uhadd16','uhadd8','uhasx','uhsub16','uhsub8','uhsax','uqadd16','uqadd8',
               'uqasx','uqsub16','uqsub8','uqsax','usub16','usub8','usax','rev','rev16','revsh','rfe',
               'sxth','sxtb16','sxtb','uxth','uxtb16','uxtb','sxtah','sxtab16','sxtab','uxtah','uxtab16',
               'uxtab','sel','smuad','smusd','smlad','smlald','smlsd','smlsld','smmul','smmla','smmls',
               'srs','ssat','ssat16','strex','umaal','usad8','usada8','usat','usat16','bxj','bkpt',
               'blx','clz','ldrd','strd','smlabb','smlatb','smlabt','smlatt','smlawb','smlawt',
               'smlalbb','smlaltb','smlalbt','smlaltt','smulbb','smultb','smulbt','smultt','smulwb',
               'smulwt','qadd','qdadd','qsub','qdsub','push','strb','str','strh','and','eor','sub',
               'rsb','add','adc','sbc','rsc','msr','mrs','tst','teq','cmp','cmn','orr','mov','lsl',
               'lsr','asr','rrx','ror','bic','mvn','pop','ldrb','ldrt','stmfd','stm','ldmfd','ldm',
               'svc','ldrh','ldrs','sevl','dcps','clrex','rfedb','rfeia','tbb','tbh','subs','srsdb',
               'srsia','smulw','smul','smull','umull','smlal','umlal','pld','smlaw','sbfx','ubfx',
               'smla','addw','subw','orn','stmia','ldmia','stmdb','ldmdb','bl']

Motorola_registers = ['d0','d1','d2','d3','d4','d5','d6','d7','a0','a1','a2','a3','a4','a5','a6','a7','usp','ssp']

Motorola_opcodes = ['abcd','addaw','addal','addib','addiw','addil','addqb','addqw','addql','addb',
                    'addw','addl','addxb','addxw','addxl','andib','andiw','andil','andi','andb','andw',
                    'andl','and','aslb','aslw','asll','asrb','asrw','asrl','bhiw','blsw','bccw','bcsw',
                    'bnew','beqw','bvcw','bvsw','bplw','bmiw','bgew','bltw','bgtw','blew','bhil','blsl',
                    'bccl','bcsl','bnel','beql','bvcl','bvsl','bpll','bmil','bgel','bltl','bgtl','blel',
                    'bhis','blss','bccs','bcss','bnes','beqs','bvcs','bvss','bpls','bmis','bges','blts',
                    'bgts','bles','jhi','jls','jcc','jcs','jne','jeq','jvc','jvs','jpl','jmi','jge','jlt',
                    'jgt','jle','bchg','bclr','bfchg','bfclr','bfexts','bfextu','bfffo','bfins','bfset',
                    'bftst','bgnd','bitrev','bkpt','braw','bral','bras','bset','bsrw','bsrl','bsrs','btst',
                    'byterev','callm','cas2w','cas2l','casb','casw','casl','chk2b','chk2w','chk2l','chkl',
                    'chkw','cinva','cinvl','cinvp','cpusha','cpushl','cpushp','clrb','clrw','clrl','cmp2b',
                    'cmp2w','cmp2l','cmpaw','cmpal','cmpib','cmpiw','cmpil','cmpmb','cmpmw','cmpml','cmpb',
                    'cmpw','cmpl','cp0bcbusy','cp1bcbusy','cp0nop','cp1nop','cp0ldb','cp1ldb','cp0ldw',
                    'cp1ldw','cp0ldl','cp1ldl','cp0ld','cp1ld','cp0stb','cp1stb','cp0stw','cp1stw','cp0stl',
                    'cp1stl','cp0st','cp1st','dbcc','dbcs','dbeq','dbf','dbge','dbgt','dbhi','dble',
                    'dbls','dblt','dbmi','dbne','dbpl','dbt','dbvc','dbvs','divsw','divsl','divsll',
                    'divuw','divul','divull','eorib','eoriw','eoril','eori','eorb','eorw','eorl','eor',
                    'exg','extw','extl','extbl','ff1','fabsb','fabsd','fabsl','fabsp','fabss','fabsw',
                    'fabsx','fsabsb','fsabsd','fsabsl','fsabsp','fsabss','fsabsw','fsabsx','fdabsb',
                    'fdabsd','fdabsl','fdabsp','fdabss','fdabsw','fdabsx','facosb','facosd','facosl',
                    'facosp','facoss','facosw','facosx','faddb','faddd','faddl','faddp','fadds','faddw',
                    'faddx','fsaddb','fsaddd','fsaddl','fsaddp','fsadds','fsaddw','fsaddx','fdaddb',
                    'fdaddd','fdaddl','fdaddp','fdadds','fdaddw','fdaddx','fasinb','fasind','fasinl',
                    'fasinp','fasins','fasinw','fasinx','fatanb','fatand','fatanl','fatanp','fatans',
                    'fatanw','fatanx','fatanhb','fatanhd','fatanhl','fatanhp','fatanhs','fatanhw',
                    'fatanhx','fnop','fbeq','fbf','fbge','fbgl','fbgle','fbgt','fble','fblt','fbne',
                    'fbnge','fbngl','fbngle','fbngt','fbnle','fbnlt','fboge','fbogl','fbogt','fbole',
                    'fbolt','fbor','fbseq','fbsf','fbsne','fbst','fbt','fbueq','fbuge','fbugt',
                    'fbule','fbult','fbun','fbeql','fbfl','fbgel','fbgll','fbglel','fbgtl','fblel',
                    'fbltl','fbnel','fbngel','fbngll','fbnglel','fbngtl','fbnlel','fbnltl','fbogel',
                    'fbogll','fbogtl','fbolel','fboltl','fborl','fbseql','fbsfl','fbsnel','fbstl',
                    'fbtl','fbueql','fbugel','fbugtl','fbulel','fbultl','fbunl','fjeq','fjf','fjge',
                    'fjgl','fjgle','fjgt','fjle','fjlt','fjne','fjnge','fjngl','fjngle','fjngt',
                    'fjnle','fjnlt','fjoge','fjogl','fjogt','fjole','fjolt','fjor','fjseq','fjsf',
                    'fjsne','fjst','fjt','fjueq','fjuge','fjugt','fjule','fjult','fjun','fcmpb',
                    'fcmpd','fcmpl','fcmpp','fcmps','fcmpw','fcmpx','fcosb','fcosd','fcosl',
                    'fcosp','fcoss','fcosw','fcosx','fcoshb','fcoshd','fcoshl','fcoshp','fcoshs',
                    'fcoshw','fcoshx','fdbeq','fdbf','fdbge','fdbgl','fdbgle','fdbgt','fdble',
                    'fdblt','fdbne','fdbnge','fdbngl','fdbngle','fdbngt','fdbnle','fdbnlt',
                    'fdboge','fdbogl','fdbogt','fdbole','fdbolt','fdbor','fdbseq','fdbsf','fdbsne',
                    'fdbst','fdbt','fdbueq','fdbuge','fdbugt','fdbule','fdbult','fdbun','fdivb',
                    'fdivd','fdivl','fdivp','fdivs','fdivw','fdivx','fsdivb','fsdivd','fsdivl',
                    'fsdivp','fsdivs','fsdivw','fsdivx','fddivb','fddivd','fddivl','fddivp','fddivs',
                    'fddivw','fddivx','fetoxb','fetoxd','fetoxl','fetoxp','fetoxs','fetoxw',
                    'fetoxx','fetoxm1b','fetoxm1d','fetoxm1l','fetoxm1p','fetoxm1s','fetoxm1w',
                    'fetoxm1x','fgetexpb','fgetexpd','fgetexpl','fgetexpp','fgetexps','fgetexpw',
                    'fgetexpx','fgetmanb','fgetmand','fgetmanl','fgetmanp','fgetmans','fgetmanw',
                    'fgetmanx','fintb','fintd','fintl','fintp','fints','fintw','fintx','fintrzb',
                    'fintrzd','fintrzl','fintrzp','fintrzs','fintrzw','fintrzx','flog10b','flog10d',
                    'flog10l','flog10p','flog10s','flog10w','flog10x','flog2b','flog2d','flog2l',
                    'flog2p','flog2s','flog2w','flog2x','flognb','flognd','flognl','flognp','flogns',
                    'flognw','flognx','flognp1b','flognp1d','flognp1l','flognp1p','flognp1s','flognp1w',
                    'flognp1x','fmodb','fmodd','fmodl','fmodp','fmods','fmodw','fmodx','fmoveb','fmoved',
                    'fmovel','fmovep','fmoves','fmovew','fmovex','fsmoveb','fsmoved','fsmovel','fsmoves',
                    'fsmovew','fsmovex','fsmovep','fdmoveb','fdmoved','fdmovel','fdmoves','fdmovew',
                    'fdmovex','fdmovep','fmovecrx','fmovemd','fmovemx','fmoveml','fmovem','fmulb','fmuld',
                    'fmull','fmulp','fmuls','fmulw','fmulx','fsmulb','fsmuld','fsmull','fsmulp','fsmuls',
                    'fsmulw','fsmulx','fdmulb','fdmuld','fdmull','fdmulp','fdmuls','fdmulw','fdmulx',
                    'fnegb','fnegd','fnegl','fnegp','fnegs','fnegw','fnegx','fsnegb','fsnegd','fsnegl',
                    'fsnegp','fsnegs','fsnegw','fsnegx','fdnegb','fdnegd','fdnegl','fdnegp','fdnegs',
                    'fdnegw','fdnegx','fremb','fremd','freml','fremp','frems','fremw','fremx',
                    'frestore','fsave','fscaleb','fscaled','fscalel','fscalep','fscales','fscalew',
                    'fscalex','fseq','fsf','fsge','fsgl','fsgle','fsgt','fsle','fslt','fsne',
                    'fsnge','fsngl','fsngle','fsngt','fsnle','fsnlt','fsoge','fsogl','fsogt','fsole',
                    'fsolt','fsor','fsseq','fssf','fssne','fsst','fst','fsueq','fsuge','fsugt',
                    'fsule','fsult','fsun','fsgldivb','fsgldivd','fsgldivl','fsgldivp','fsgldivs',
                    'fsgldivw','fsgldivx','fsglmulb','fsglmuld','fsglmull','fsglmulp','fsglmuls',
                    'fsglmulw','fsglmulx','fsinb','fsind','fsinl','fsinp','fsins','fsinw','fsinx',
                    'fsincosb','fsincosd','fsincosl','fsincosp','fsincoss','fsincosw','fsincosx',
                    'fsinhb','fsinhd','fsinhl','fsinhp','fsinhs','fsinhw','fsinhx','fsqrtb',
                    'fsqrtd','fsqrtl','fsqrtp','fsqrts','fsqrtw','fsqrtx','fssqrtb','fssqrtd',
                    'fssqrtl','fssqrtp','fssqrts','fssqrtw','fssqrtx','fdsqrtb','fdsqrtd',
                    'fdsqrtl','fdsqrtp','fdsqrts','fdsqrtw','fdsqrtx','fsubb','fsubd','fsubl',
                    'fsubp','fsubs','fsubw','fsubx','fssubb','fssubd','fssubl','fssubp','fssubs',
                    'fssubw','fssubx','fdsubb','fdsubd','fdsubl','fdsubp','fdsubs','fdsubw',
                    'fdsubx','ftanb','ftand','ftanl','ftanp','ftans','ftanw','ftanx','ftanhb',
                    'ftanhd','ftanhl','ftanhp','ftanhs','ftanhw','ftanhx','ftentoxb','ftentoxd',
                    'ftentoxl','ftentoxp','ftentoxs','ftentoxw','ftentoxx','ftrapeq','ftrapf',
                    'ftrapge','ftrapgl','ftrapgle','ftrapgt','ftraple','ftraplt','ftrapne','ftrapnge',
                    'ftrapngl','ftrapngle','ftrapngt','ftrapnle','ftrapnlt','ftrapoge','ftrapogl',
                    'ftrapogt','ftrapole','ftrapolt','ftrapor','ftrapseq','ftrapsf','ftrapsne',
                    'ftrapst','ftrapt','ftrapueq','ftrapuge','ftrapugt','ftrapule','ftrapult',
                    'ftrapun','ftrapeqw','ftrapfw','ftrapgew','ftrapglw','ftrapglew','ftrapgtw',
                    'ftraplew','ftrapltw','ftrapnew','ftrapngew','ftrapnglw','ftrapnglew',
                    'ftrapngtw','ftrapnlew','ftrapnltw','ftrapogew','ftrapoglw','ftrapogtw',
                    'ftrapolew','ftrapoltw','ftraporw','ftrapseqw','ftrapsfw','ftrapsnew',
                    'ftrapstw','ftraptw','ftrapueqw','ftrapugew','ftrapugtw','ftrapulew',
                    'ftrapultw','ftrapunw','ftrapeql','ftrapfl','ftrapgel','ftrapgll','ftrapglel',
                    'ftrapgtl','ftraplel','ftrapltl','ftrapnel','ftrapngel','ftrapngll','ftrapnglel',
                    'ftrapngtl','ftrapnlel','ftrapnltl','ftrapogel','ftrapogll','ftrapogtl',
                    'ftrapolel','ftrapoltl','ftraporl','ftrapseql','ftrapsfl','ftrapsnel',
                    'ftrapstl','ftraptl','ftrapueql','ftrapugel','ftrapugtl','ftrapulel','ftrapultl',
                    'ftrapunl','ftstb','ftstd','ftstl','ftstp','ftsts','ftstw','ftstx','ftwotoxb',
                    'ftwotoxd','ftwotoxl','ftwotoxp','ftwotoxs','ftwotoxw','ftwotoxx',
                    'halt','illegal','intouch','jmp','jra','jsr','jbsr','lea','lpstop','linkw',
                    'linkl','link','lslb','lslw','lsll','lsrb','lsrw','lsrl','macw','macl','moveal',
                    'moveaw','movclrl','movec','movemw','moveml','movepw','movepl','moveq','moveb',
                    'movew','movel','move','mov3ql','mvsb','mvsw','mvzb','mvzw','movesb','movesw',
                    'movesl','move16','msacw','msacl','mulsw','mulsl','muluw','mulul','nbcd','negb',
                    'negw','negl','negxb','negxw','negxl','nop','notb','notw','notl','orib','oriw',
                    'oril','ori','orb','orw','orl','or','pack','pbac','pbacw','pbas','pbasw','pbbc',
                    'pbbcw','pbbs','pbbsw','pbcc','pbccw','pbcs','pbcsw','pbgc','pbgcw','pbgs','pbgsw',
                    'pbic','pbicw','pbis','pbisw','pblc','pblcw','pbls','pblsw','pbsc','pbscw','pbss',
                    'pbssw','pbwc','pbwcw','pbws','pbwsw','pdbac','pdbas','pdbbc','pdbbs','pdbcc',
                    'pdbcs','pdbgc','pdbgs','pdbic','pdbis','pdblc','pdbls','pdbsc','pdbss','pdbwc',
                    'pdbws','pea','pflusha','pflush','pflushan','pflushn','pflushr','pflushs','ploadr',
                    'ploadw','plpar','plpaw','pmove','pmovefd','prestore','psave','psac','psas','psbc',
                    'psbs','pscc','pscs','psgc','psgs','psic','psis','pslc','psls','pssc','psss','pswc',
                    'psws','ptestr','ptestw','ptrapacw','ptrapacl','ptrapac','ptrapasw','ptrapasl',
                    'ptrapas','ptrapbcw','ptrapbcl','ptrapbc','ptrapbsw','ptrapbsl','ptrapbs','ptrapccw',
                    'ptrapccl','ptrapcc','ptrapcsw','ptrapcsl','ptrapcs','ptrapgcw','ptrapgcl',
                    'ptrapgc','ptrapgsw','ptrapgsl','ptrapgs','ptrapicw','ptrapicl','ptrapic',
                    'ptrapisw','ptrapisl','ptrapis','ptraplcw','ptraplcl','ptraplc','ptraplsw',
                    'ptraplsl','ptrapls','ptrapscw','ptrapscl','ptrapsc','ptrapssw','ptrapssl',
                    'ptrapss','ptrapwcw','ptrapwcl','ptrapwc','ptrapwsw','ptrapwsl','ptrapws',
                    'pulse','pvalid','remsl','remul','reset','rolb','rolw','roll','rorb','rorw',
                    'rorl','roxlb','roxlw','roxll','roxrb','roxrw','roxrl','rtd','rte','rtm','rtr',
                    'rts','satsl','sbcd','stldsr','trapcc','trapcs','trapeq','tpf','trapf','trapge',
                    'trapgt','traphi','traple','trapls','traplt','trapmi','trapne','trappl','trapt',
                    'trapvc','trapvs','trapccw','trapcsw','trapeqw','tpfw','trapfw','trapgew','trapgtw',
                    'traphiw','traplew','traplsw','trapltw','trapmiw','trapnew','trapplw','traptw',
                    'trapvcw','trapvsw','trapccl','trapcsl','trapeql','tpfl','trapfl','trapgel','trapgtl',
                    'traphil','traplel','traplsl','trapltl','trapmil','trapnel','trappll','traptl',
                    'trapvcl','trapvsl','trapv','scc','scs','seq','sf','sge','sgt','shi','sle','sls',
                    'slt','smi','sne','spl','st','svc','svs','sleep','stop','strldsr','subal','subaw',
                    'subib','subiw','subil','subqb','subqw','subql','subb','subw','subl','subxb','subxw',
                    'subxl','swap','swbeg','swbegl','tas','trap','trapx','tstb','tstw','tstl','unlk','unpk',
                    'wddatab','wddataw','wddatal','wdebugl','wdebug']

PowerPC_registers = ['r0','r1','r2','r3','r4','r5','r6','r7','r8','r9','r10','r11','r12','r13','r14','r15',
                    'r16','r17','r18','r19','r20','r21','r22','r23','r24','r25','r26','r27','r28','r29','r30','r31']

PowerPC_opcodes = ['add','addc','adde','addi','addic','addic.','addis','addme','addze','and','andc','andi.','andis.',
                   'b','bc','bcctr','bclr','cmp','cmpi','cmpl','cmpli','cntlzd','cntlzw','crand','crandc','creqv',
                   'crnand','crnor','cror','crorc','crxor','dcbf','dcbst','dcbt','dcbtst','dcbz','divd','divdu',
                   'divw','divwu','eciwx','ecowx','eieio','eqv','extsb','extsh','extsw','fabs','fadd','fadds',
                   'fcfid','fcmpo','fcmpu','fctid','fctidz','fctiw','fctiwz','fdiv','fdivs','fmadd','fmadds',
                   'fmr','fmsub','fmsubs','fmul','fmuls','fnabs','fneg','fnmadd','fnmadds','fnmsub','fnmsubs',
                   'fre','fres','frsp','frsqrte','frsqrtes','fsel','fsqrt','fsqrts','fsub','fsubs','hrfid','icbi',
                   'isync','lbz','lbzu','lbzux','lbzx','ld','ldarx','ldu','ldux','ldx','lfd','lfdu','lfdux','lfdx',
                   'lfs','lfsu','lfsux','lfsx','lha','lhau','lhaux','lhax','lhbrx','lhz','lhzu','lhzux','lhzx','lmw',
                   'lswi','lswx','lwa','lwarx','lwaux','lwax','lwbrx','lwz','lwzu','lwzux','lwzx','mcrf','mcrfs',
                   'mcrxr','mfcr','mfocrf','mffs','mfmsr','mfspr','mfsr','mfsrin','mftb','mtcrf','mtocrf','mtfsb0',
                   'mtfsb1','mtfsf','mtfsfi','mtmsr','mtmsrd','mtspr','mtsr','mtsrin','mulhd','mulhdu','mulhw','mulhwu',
                   'mulld','mulli','mullw','nand','neg','nor','or','orc','ori','oris','popcntb','rfid','rldcl','rldcr',
                   'rldic','rldicl','rldicr','rldimi','rlwimi','rlwinm','rlwnm','sc','slbia','slbie','slbmfee',
                   'slbmfev','slbmte','sld','slw','srad','sradi','sraw','srawi','srd','srw','stb','stbu','stbux',
                   'stbx','std','stdcx.','stdu','stdux','stdx','stfd','stfdu','stfdux','stfdx','stfiwx','stfs',
                   'stfsu','stfsux','stfsx','sth','sthbrx','sthu','sthux','sthx','stmw','stswi','stswx','stw',
                   'stwbrx','stwcx.','stwu','stwux','stwx','subf','subfc','subfe','subfic','subfme','subfze',
                   'sync','td','tdi','tlbia','tlbie','tlbsync','tw','twi','xor','xori','xoris']




ELF_sections = ['.bss','.comment','.ctors','.data','.data.rel.ro','.debug_abbrev','.debug_aranges',
                '.debug_frame','.debug_info','.debug_line','.debug_loc','.debug_pubnames',
                '.debug_ranges','.debug_str','.dtors','.dynamic','.dynsym','.dynstr','.eh_frame',
                '.eh_frame_hdr','.fini','.fini_array','.gcc_except_table','.gnu_debuglink','.gnu_extab',
                '.gnu.hash','.gnu.version','.gnu.version_r','.got','.hash','.init','.init_array',
                '.interp','.jcr','.noptrbss','.note.gnu.build-id','.pdr','.plt','.preinit_array',
                '.rel.dyn','.rel.plt','.rodata','.sbss','.sdata','.shstrtab','.strtab','.symtab',
                '.tbss','.tdata','.text']


def count_asm_symbols(asm_code):
    symbols = [0]*7
    for row in asm_code:
        if '*' in row:
            symbols[0] += 1
        if '-' in row:
            symbols[1] += 1
        if '+' in row:
            symbols[2] += 1
        if '[' in row:
            symbols[3] += 1
        if ']' in row:
            symbols[4] += 1
        if '@' in row:
            symbols[5] += 1
        if '?' in row:
            symbols[6] += 1

    return symbols


def count_asm_registers(asm_code):
    registers_values = [0]*len(registers)
    for row in asm_code:
        parts = row.replace(',',' ').replace('+',' ').replace('*',' ').replace('[',' ').replace(']',' ') \
                    .replace('-',' ').split()
        for register in registers:
            registers_values[registers.index(register)] += parts.count(register)
    return registers_values


def count_asm_opcodes(asm_code):
    opcodes_values = [0]*len(opcodes)
    for row in asm_code:
        parts = row.split()

        for opcode in opcodes:
            if opcode in parts:
                opcodes_values[opcodes.index(opcode)] += 1
                break
    return opcodes_values


def count_asm_APIs(asm_code, apis):
    apis_values = [0]*len(apis)
    for row in asm_code:
        for i in range(len(apis)):
            if apis[i] in row:
                apis_values[i] += 1
                break
    return apis_values


def count_asm_misc(asm_code):
    keywords_values = [0]*len(keywords)
    for row in asm_code:
        for i in range(len(keywords)):
            if keywords[i] in row:
                keywords_values[i] += 1
                break
    return keywords_values


def get_elf_file_list(ext_drive, packer_id_feature_file, file_id_feature_file, trid_id_feature_file):
    # Load the malware packer id features and file id features from the sample set.
    packer_id_features = pd.read_csv(packer_id_feature_file)
    file_id_features = pd.read_csv(file_id_feature_file)
    trid_id_features = pd.read_csv(trid_id_feature_file)
    
    counter = 0

    file_names_list = file_id_features['file_name']
    file_list = []
    write_list = []
    fid_list = []
    
    for idx, file_name in enumerate(file_names_list):
        trid_name = trid_id_features.iloc[idx, 1]
        fid_name = file_id_features.iloc[idx, 1]
        
        if trid_name.find('ELF') > -1 or fid_name.find('ELF') > -1:
            print('Found: {:s} - {:s}'.format(trid_name, fid_name))
            counter += 1
            full_name = ext_drive + "VirusShare_" + file_name
            write_list =  full_name + "\n"
            file_list.append(full_name)
            fid_list.append(fid_name)


        
    fop = open('data/elf-file-list.txt','w')
    fop.writelines(write_list)
    fop.close()
    
    print("Got {:d} ELF filenames.".format(counter))

    return file_list, fid_list


get_column_names(fid_name):
    
    colnames = []
    
    if "Intel" in fid_name:

    elif "x86" in fid_name:

    elif "ARM" in fid_name:
        
    elif "PowerPC" in fid_name:
        
    elif "Motorola" in fid_name:
        
    elif "SPARC" in fid_name:
        
    elif "MIPS" in fid_name:
        
    elif "Renesas" in fid_name: # SuperH
        
        
    return colnames

                
# Extract features from test/training asm files, file list is passed in as a parameter

def extract_asm_features(asm_files, feature_file, api_file):
    
    pid = os.getpid()
    print('Process id:', pid)
    feature_path = 'data/' + feature_file # libc API, symbols, registers, opcodes, etc...   
    print('feature file:', feature_file)

    fapi = open('data/' + api_file)
    defined_apis = fapi.readlines()
    for idx, fname in defined_apis:
        defined_apis[idx] = fname.rstrip() # Remove newlines, they are annoying.

    #asm_files = [i for i in tfiles if '.asm' in i]
    ftot = len(asm_files)
    
    feature_counts = []
    with open(feature_path, 'w') as f:
        # write the csv header
        fw = writer(f)
        colnames = ['file_name'] + ELF_sections + defined_apis
        fw.writerow(colnames)
        
        for idx, fname in enumerate(asm_files):
            fasm = open(ext_drive + fname, 'r')
            content = fasm.readlines()
            
            #reg_vals = count_asm_registers(content)
            #opc_vals = count_asm_opcodes(content)
            api_vals = count_asm_APIs(content, defined_apis)
            #sec_vals = count_asm_sections(content)
            #mis_vals = count_asm_misc(content)
            count_vals = sec_vals + api_vals
            
            feature_counts.append([fname[:fname.find('.asm')]] + count_vals)   
            
            # Writing rows after every 10 files processed
            if (idx+1) % 10 == 0:
                print("{:d} Processed {:d} of {:d} total files.".format(pid, idx + 1, ftot))
                fw.writerows(feature_counts)
                feature_counts = []
                
        # Writing remaining files
        if len(feature_counts) > 0:
            fw.writerows(feature_counts)
            feature_counts = []

    
    feats = pd.read_csv('data/elf-asm-features.csv')
    # DataFrame.sort() is deprecated, but this is an old version of pandas, does not have sort_values().
    sorted_feats = feats.sort('file_name')
    sorted_feats.to_csv('data/sorted-elf-asm-features.csv', index=False)
    
    return




# Start of Script


# TODO: add command line arguments to specify file names.

#ext_drive = '/opt/vs/train2/'
#packer_id_file = 'data/sorted-packer-id-features-vs252.csv'
#file_id_file = 'data/sorted-file-id-features-vs252.csv'
#trid_id_file = 'data/sorted-trid-id-features-vs252.csv'
    
#unflist, fidlist = get_elf_file_list(ext_drive, packer_id_file, file_id_file, trid_id_file)


ext_drive = '/opt/vs/train1/'

file_list = os.listdir(ext_drive)
tfiles = []

for fname in file_list:
    fname = fname.rstrip()
    if fname.endswith('.elf.asm'):
        tfiles.append(ext_drive + fname)


print("Total Files: {:d}".format(len(tfiles)))

extract_asm_features(tfiles, "elf-asm-features.csv", "elf-libc-api.txt")


# End of Script
    
